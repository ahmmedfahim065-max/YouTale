<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YouTale - Login</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #4f46e5 0%, #2563eb 100%);
            min-height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
        }
        .glass-card { 
            background: rgba(255, 255, 255, 0.95); 
            backdrop-filter: blur(10px); 
            border-radius: 1.5rem; 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); 
        }
        .tab-btn { transition: all 0.3s ease; }
        .tab-btn.active { border-bottom: 3px solid #4f46e5; color: #4f46e5; font-weight: bold; }
        .tab-btn.inactive { border-bottom: 3px solid transparent; color: #9ca3af; font-weight: normal; }
        input:focus { outline: none; border-color: #4f46e5; box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); }
    </style>
</head>
<body class="p-4">

    <div class="glass-card w-full max-w-md p-6 relative">
        <!-- Back Button -->
        <button onclick="window.location.href='index.html'" class="absolute top-6 left-6 text-gray-400 hover:text-gray-800 flex items-center gap-1 transition">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        </button>

        <div class="text-center mb-6 mt-2">
            <h2 class="text-3xl font-extrabold text-gray-800 tracking-tight">YouTale</h2>
            <p class="text-gray-500 text-sm mt-1" id="txt-subtitle">পড়ুন, লিখুন এবং আয় করুন</p>
        </div>

        <div class="flex border-b border-gray-200 mb-6">
            <button onclick="switchTab('login')" id="tab-login" class="flex-1 py-3 text-center tab-btn active">লগইন</button>
            <button onclick="switchTab('register')" id="tab-register" class="flex-1 py-3 text-center tab-btn inactive">রেজিস্ট্রেশন</button>
        </div>

        <!-- Login Form -->
        <div id="form-login" class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" id="lbl-email">ইমেইল</label>
                <input type="email" id="login-email" class="w-full bg-gray-50 border border-gray-200 text-gray-800 rounded-xl py-3.5 px-4 transition" placeholder="example@mail.com">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" id="lbl-pass">পাসওয়ার্ড</label>
                <input type="password" id="login-password" class="w-full bg-gray-50 border border-gray-200 text-gray-800 rounded-xl py-3.5 px-4 transition" placeholder="••••••••">
            </div>
            <button onclick="processLogin()" id="btn-login-text" class="w-full bg-indigo-600 text-white rounded-xl py-4 font-bold mt-2 hover:bg-indigo-700 active:scale-95 transition shadow-lg shadow-indigo-200">লগইন করুন</button>
            <button onclick="resetPassword()" id="btn-forgot" class="w-full text-center text-sm font-medium text-indigo-600 hover:text-indigo-800 mt-2 transition">পাসওয়ার্ড ভুলে গেছেন?</button>
        </div>

        <!-- Register Form -->
        <div id="form-register" class="space-y-4 hidden">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" id="lbl-name">সম্পূর্ণ নাম</label>
                <input type="text" id="reg-name" class="w-full bg-gray-50 border border-gray-200 text-gray-800 rounded-xl py-3.5 px-4 transition" placeholder="আপনার নাম">
            </div>
            <div><label class="block text-sm font-medium text-gray-700 mb-1">ইমেইল</label><input type="email" id="reg-email" class="w-full bg-gray-50 border border-gray-200 text-gray-800 rounded-xl py-3.5 px-4 transition" placeholder="example@mail.com"></div>
            <div><label class="block text-sm font-medium text-gray-700 mb-1">পাসওয়ার্ড</label><input type="password" id="reg-password" class="w-full bg-gray-50 border border-gray-200 text-gray-800 rounded-xl py-3.5 px-4 transition" placeholder="অন্তত ৬ অক্ষরের"></div>
            <button onclick="processRegister()" id="btn-reg-text" class="w-full bg-green-600 text-white rounded-xl py-4 font-bold mt-2 hover:bg-green-700 active:scale-95 transition shadow-lg shadow-green-200">একাউন্ট তৈরি করুন</button>
        </div>

        <div id="auth-message" class="mt-4 text-center text-sm font-bold p-3 rounded-lg hidden"></div>

        <div class="relative flex items-center my-6"><div class="flex-grow border-t border-gray-200"></div><span class="flex-shrink-0 mx-4 text-gray-400 text-xs font-semibold">অথবা</span><div class="flex-grow border-t border-gray-200"></div></div>

        <button onclick="continueAsGuest()" id="btn-guest-text" class="w-full bg-white text-gray-700 border-2 border-gray-200 rounded-xl py-3.5 font-bold hover:bg-gray-50 transition active:scale-95">একাউন্ট ছাড়া পড়ুন</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, updateProfile, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // আপনার ফায়ারবেস কনফিগারেশন (আপনার দেওয়া কোড)
        const firebaseConfig = {
            apiKey: "AIzaSyB9WjFq4Ips9wMKoDmO8v2M6aZ2OxynQQo",
            authDomain: "youtale-f6845.firebaseapp.com",
            projectId: "youtale-f6845",
            storageBucket: "youtale-f6845.firebasestorage.app",
            messagingSenderId: "10854951568",
            appId: "1:10854951568:web:cffcc9813d858e130d8615",
            measurementId: "G-04CV21FSB7"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // ভাষা অনুবাদ
        const translations = {
            'en': { sub: 'Read, Write and Earn', loginTab: 'Login', regTab: 'Register', email: 'Email', pass: 'Password', name: 'Full Name', loginBtn: 'Login', regBtn: 'Create Account', guestBtn: 'Read without Account', forgot: 'Forgot Password?' },
            'bn': { sub: 'পড়ুন, লিখুন এবং আয় করুন', loginTab: 'লগইন', regTab: 'রেজিস্ট্রেশন', email: 'ইমেইল', pass: 'পাসওয়ার্ড', name: 'সম্পূর্ণ নাম', loginBtn: 'লগইন করুন', regBtn: 'একাউন্ট তৈরি করুন', guestBtn: 'একাউন্ট ছাড়া পড়ুন', forgot: 'পাসওয়ার্ড ভুলে গেছেন?' }
        };

        const userLang = localStorage.getItem('youtale_lang') || 'en';
        const t = translations[userLang] || translations['en'];

        document.getElementById('txt-subtitle').innerText = t.sub;
        document.getElementById('tab-login').innerText = t.loginTab;
        document.getElementById('tab-register').innerText = t.regTab;
        document.getElementById('lbl-email').innerText = t.email;
        document.getElementById('lbl-pass').innerText = t.pass;
        document.getElementById('lbl-name').innerText = t.name;
        document.getElementById('btn-login-text').innerText = t.loginBtn;
        document.getElementById('btn-reg-text').innerText = t.regBtn;
        document.getElementById('btn-guest-text').innerText = t.guestBtn;
        document.getElementById('btn-forgot').innerText = t.forgot;

        window.switchTab = (tab) => {
            const loginForm = document.getElementById('form-login'), regForm = document.getElementById('form-register');
            const loginTab = document.getElementById('tab-login'), regTab = document.getElementById('tab-register');
            if (tab === 'login') {
                loginForm.classList.remove('hidden'); regForm.classList.add('hidden');
                loginTab.className = 'flex-1 py-3 text-center tab-btn active'; regTab.className = 'flex-1 py-3 text-center tab-btn inactive';
            } else {
                loginForm.classList.add('hidden'); regForm.classList.remove('hidden');
                loginTab.className = 'flex-1 py-3 text-center tab-btn inactive'; regTab.className = 'flex-1 py-3 text-center tab-btn active';
            }
            document.getElementById('auth-message').classList.add('hidden');
        };

        window.processLogin = async () => {
            const email = document.getElementById('login-email').value, pass = document.getElementById('login-password').value;
            if(!email || !pass) return showMsg('দয়া করে ইমেইল ও পাসওয়ার্ড দিন', true);
            try {
                showMsg('লগইন হচ্ছে...', false);
                await signInWithEmailAndPassword(auth, email, pass);
                window.location.href = "dashboard.html";
            } catch(e) { showMsg('লগইন ব্যর্থ। ইমেইল বা পাসওয়ার্ড ভুল।', true); }
        };

        window.processRegister = async () => {
            const name = document.getElementById('reg-name').value, email = document.getElementById('reg-email').value, pass = document.getElementById('reg-password').value;
            if(!name || !email || !pass) return showMsg('সবগুলো ঘর পূরণ করুন', true);
            if(pass.length < 6) return showMsg('পাসওয়ার্ড অন্তত ৬ অক্ষরের দিন', true);
            try {
                showMsg('একাউন্ট তৈরি হচ্ছে...', false);
                const userCred = await createUserWithEmailAndPassword(auth, email, pass);
                await updateProfile(userCred.user, { displayName: name });
                await setDoc(doc(db, 'users', userCred.user.uid), { name, email, role: 'user', earnings: 0, followers: 0, joinedAt: new Date().toISOString() });
                window.location.href = "dashboard.html";
            } catch(e) { showMsg('একাউন্ট তৈরি করা যায়নি। ইমেইলটি চেক করুন।', true); }
        };

        window.resetPassword = async () => {
            const email = document.getElementById('login-email').value;
            if(!email) return showMsg('প্রথমে ইমেইল বক্সে আপনার ইমেইলটি লিখুন।', true);
            try { await sendPasswordResetEmail(auth, email); showMsg('রিসেট লিংক আপনার ইমেইলে পাঠানো হয়েছে।', false); }
            catch(e) { showMsg('লিংক পাঠানো যায়নি।', true); }
        };

        window.continueAsGuest = () => { localStorage.setItem('youtale_guest', 'true'); window.location.href = "dashboard.html"; };

        function showMsg(msg, isError) {
            const box = document.getElementById('auth-message');
            box.innerText = msg; box.className = `mt-4 text-center text-sm font-bold p-3 rounded-lg ${isError ? 'bg-red-100 text-red-600' : 'bg-green-100 text-green-700'}`;
            box.classList.remove('hidden');
        }
    </script>
</body>
</html>
