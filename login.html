<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YouTale - Enter the World of Stories</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(-45deg, #0f172a, #1e1b4b, #581c87, #0f172a);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
        }
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .glass-card { 
            background: rgba(255, 255, 255, 0.05); 
            backdrop-filter: blur(25px); 
            border-radius: 2.5rem; 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .brand-text {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(to right, #818cf8, #f472b6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .input-box {
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            transition: 0.3s;
        }
        .input-box:focus {
            background: rgba(255, 255, 255, 0.12);
            border-color: #818cf8;
            box-shadow: 0 0 15px rgba(129, 140, 248, 0.3);
        }
        .tab-btn.active { color: #818cf8; border-bottom: 3px solid #818cf8; }
        .story-badge {
            font-size: 9px; padding: 2px 8px; border-radius: 50px;
            background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.6);
            margin: 0 3px; border: 1px solid rgba(255,255,255,0.05);
        }
        #auto-loader { transition: opacity 0.5s ease; }
    </style>
</head>
<body class="p-4">

    <!-- Loading Overlay -->
    <div id="auto-loader" class="fixed inset-0 z-[100] bg-[#0f172a] flex flex-col items-center justify-center">
        <h1 class="text-4xl font-extrabold brand-text mb-4">YouTale</h1>
        <div class="w-10 h-10 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div>
    </div>

    <div class="glass-card w-full max-w-md p-8 md:p-10 relative overflow-hidden">
        <button onclick="continueAsGuest()" class="w-full bg-white/5 text-gray-300 rounded-xl py-2 font-medium hover:bg-white/10 active:scale-95 text-xs transition-all mb-8 border border-white/5">
            üïµÔ∏è‚Äç‚ôÇÔ∏è Read stories without an account
        </button>

        <div class="text-center mb-8 relative z-10">
            <h2 class="text-5xl font-extrabold brand-text tracking-tighter mb-3">YouTale</h2>
            <div class="flex justify-center flex-wrap gap-1 mb-4">
                <span class="story-badge">HORROR</span>
                <span class="story-badge">ROMANTIC</span>
                <span class="story-badge">MYTHOLOGY</span>
                <span class="story-badge">SCIFI</span>
            </div>
            <p class="text-gray-400 text-sm font-medium">Read, Write, and Inspire the World</p>
        </div>

        <div class="flex border-b border-white/10 mb-8 relative z-10 text-sm">
            <button onclick="switchTab('login')" id="tab-login" class="flex-1 py-3 text-center font-bold text-gray-500 active">SIGN IN</button>
            <button onclick="switchTab('register')" id="tab-register" class="flex-1 py-3 text-center font-bold text-gray-500">SIGN UP</button>
        </div>

        <div id="form-login" class="space-y-5 relative z-10">
            <div class="relative">
                <span class="absolute inset-y-0 left-4 flex items-center text-gray-500">üìß</span>
                <input type="email" id="login-email" class="input-box w-full rounded-2xl py-4 pl-12 pr-5 outline-none text-sm" placeholder="Email Address">
            </div>
            <div class="relative">
                <span class="absolute inset-y-0 left-4 flex items-center text-gray-500">üîë</span>
                <input type="password" id="login-password" class="input-box w-full rounded-2xl py-4 pl-12 pr-5 outline-none text-sm" placeholder="Password">
            </div>
            <div class="text-right px-1">
                <button onclick="forgotPassword()" class="text-xs font-semibold text-indigo-400 hover:text-pink-400 transition-colors">Forgot Password?</button>
            </div>
            <button onclick="processLogin()" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-2xl py-4 font-bold shadow-xl active:scale-95 transition-all">Sign In</button>
        </div>

        <div id="form-register" class="space-y-5 hidden relative z-10">
            <input type="text" id="reg-name" class="input-box w-full rounded-2xl py-4 px-5 outline-none text-sm" placeholder="Your Full Name">
            <input type="email" id="reg-email" class="input-box w-full rounded-2xl py-4 px-5 outline-none text-sm" placeholder="Email Address">
            <input type="password" id="reg-password" class="input-box w-full rounded-2xl py-4 px-5 outline-none text-sm" placeholder="Password (6+ chars)">
            <button onclick="processRegister()" class="w-full bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-2xl py-4 font-bold shadow-xl active:scale-95 transition-all">Create Account</button>
        </div>

        <div id="auth-message" class="mt-4 text-center text-xs font-bold p-3 rounded-xl hidden"></div>

        <div class="relative flex items-center my-8">
            <div class="flex-grow border-t border-white/10"></div>
            <span class="flex-shrink-0 mx-4 text-gray-500 text-[10px] font-bold uppercase tracking-widest">OR</span>
            <div class="flex-grow border-t border-white/10"></div>
        </div>

        <button onclick="loginWithGoogle()" class="w-full bg-white/10 text-white border border-white/10 rounded-2xl py-4 font-bold flex items-center justify-center gap-3 hover:bg-white/20 active:scale-95 transition-all">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/action/google.svg" class="w-6 h-6">
            Continue with Google
        </button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword, updateProfile, GoogleAuthProvider, signInWithPopup, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB9WjFq4Ips9wMKoDmO8v2M6aZ2OxynQQo",
            authDomain: "youtale-f6845.firebaseapp.com",
            projectId: "youtale-f6845",
            storageBucket: "youtale-f6845.firebasestorage.app",
            messagingSenderId: "10854951568",
            appId: "1:10854951568:web:cffcc9813d858e130d8615"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const googleProvider = new GoogleAuthProvider();

        onAuthStateChanged(auth, (user) => {
            const loader = document.getElementById('auto-loader');
            if (user) {
                window.location.href = "index.html";
            } else {
                loader.style.opacity = '0';
                setTimeout(() => loader.style.display = 'none', 500);
            }
        });

        window.switchTab = (tab) => {
            const isLogin = tab === 'login';
            document.getElementById('form-login').classList.toggle('hidden', !isLogin);
            document.getElementById('form-register').classList.toggle('hidden', isLogin);
            document.getElementById('tab-login').classList.toggle('active', isLogin);
            document.getElementById('tab-register').classList.toggle('active', !isLogin);
        };

        window.processLogin = async () => {
            const e = document.getElementById('login-email').value, p = document.getElementById('login-password').value;
            try { await signInWithEmailAndPassword(auth, e, p); } catch(err) { showMsg('Login failed!', true); }
        };

        window.processRegister = async () => {
            const n = document.getElementById('reg-name').value, e = document.getElementById('reg-email').value, p = document.getElementById('reg-password').value;
            try {
                const cred = await createUserWithEmailAndPassword(auth, e, p);
                await updateProfile(cred.user, { displayName: n });
                await setDoc(doc(db, 'artifacts', 'YouTale-V10-Final', 'users', cred.user.uid, 'profile'), {
                    name: n, email: e, balance: 0, createdAt: new Date().toISOString()
                });
            } catch(err) { showMsg('Registration failed!', true); }
        };

        window.loginWithGoogle = async () => {
            try { await signInWithPopup(auth, googleProvider); } catch(err) { showMsg('Google failed!', true); }
        };

        window.continueAsGuest = () => { localStorage.setItem('youtale_guest', 'true'); window.location.href = "index.html"; };

        function showMsg(m, isE) {
            const box = document.getElementById('auth-message');
            box.innerText = m; box.className = `mt-4 text-center text-xs font-bold p-3 rounded-xl ${isE ? 'bg-red-500/20 text-red-400' : 'bg-green-500/20 text-green-400'}`;
            box.classList.remove('hidden');
        }
    </script>
</body>
</html>
