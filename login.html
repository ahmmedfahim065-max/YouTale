<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YouTale - Welcome</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&family=Poppins:wght@800&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Hind Siliguri', sans-serif; 
            background: linear-gradient(-45deg, #4f46e5, #7c3aed, #db2777, #2563eb);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            user-select: none;
        }
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .glass-card { 
            background: rgba(255, 255, 255, 0.9); 
            backdrop-filter: blur(20px); 
            border-radius: 2.5rem; 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .brand-text {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(to right, #4f46e5, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .input-box {
            background: rgba(243, 244, 246, 0.8);
            border: 2px solid transparent;
            transition: 0.3s;
        }
        .input-box:focus {
            background: #fff;
            border-color: #7c3aed;
            box-shadow: 0 0 15px rgba(124, 58, 237, 0.2);
        }
        .tab-btn.active { color: #4f46e5; }
        .tab-btn.active::after {
            content: ''; position: absolute; bottom: -2px; left: 25%; width: 50%; height: 4px;
            background: linear-gradient(to right, #4f46e5, #ec4899); border-radius: 10px;
        }
    </style>
</head>
<body class="p-4">

    <div class="glass-card w-full max-w-md p-8 md:p-10 relative overflow-hidden">
        
        <div class="text-center mb-10 relative z-10">
            <h2 class="text-5xl font-extrabold brand-text tracking-tighter mb-2">YouTale</h2>
            <p class="text-gray-500 text-sm font-semibold" id="txt-subtitle">‡¶™‡ßú‡ßÅ‡¶®, ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡ßü ‡¶ï‡¶∞‡ßÅ‡¶®</p>
        </div>

        <!-- ‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨ ‡¶∏‡ßÅ‡¶á‡¶ö‡¶ø‡¶Ç -->
        <div class="flex border-b border-gray-100 mb-8 relative z-10">
            <button onclick="switchTab('login')" id="tab-login" class="flex-1 py-3 text-center relative font-bold text-gray-400 active">‡¶≤‡¶ó‡¶á‡¶®</button>
            <button onclick="switchTab('register')" id="tab-register" class="flex-1 py-3 text-center relative font-bold text-gray-400">‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®</button>
        </div>

        <!-- ‡¶≤‡¶ó‡¶á‡¶® ‡¶´‡¶∞‡ßç‡¶Æ -->
        <div id="form-login" class="space-y-4 relative z-10">
            <div class="relative">
                <span class="absolute inset-y-0 left-4 flex items-center text-gray-400">üìß</span>
                <input type="email" id="login-email" class="input-box w-full rounded-2xl py-4 pl-12 pr-5 outline-none" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶Ü‡¶á‡¶°‡¶ø">
            </div>
            <div class="relative">
                <span class="absolute inset-y-0 left-4 flex items-center text-gray-400">üîë</span>
                <input type="password" id="login-password" class="input-box w-full rounded-2xl py-4 pl-12 pr-5 outline-none" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°">
            </div>
            
            <!-- ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßÅ‡¶≤‡ßá ‡¶ó‡ßá‡¶õ‡ßá‡¶® ‡¶¨‡¶æ‡¶ü‡¶® -->
            <div class="text-right px-1">
                <button onclick="forgotPassword()" class="text-xs font-bold text-indigo-600 hover:text-pink-600 transition-colors">‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßÅ‡¶≤‡ßá ‡¶ó‡ßá‡¶õ‡ßá‡¶®?</button>
            </div>

            <button onclick="processLogin()" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-2xl py-4 font-bold shadow-xl active:scale-95 transition-all">
                ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
            </button>
        </div>

        <!-- ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶´‡¶∞‡ßç‡¶Æ -->
        <div id="form-register" class="space-y-4 hidden relative z-10">
            <input type="text" id="reg-name" class="input-box w-full rounded-2xl py-4 px-5 outline-none" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡¶æ‡¶Æ">
            <input type="email" id="reg-email" class="input-box w-full rounded-2xl py-4 px-5 outline-none" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶Ü‡¶á‡¶°‡¶ø">
            <input type="password" id="reg-password" class="input-box w-full rounded-2xl py-4 px-5 outline-none" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° (‡ß¨+ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞)">
            <button onclick="processRegister()" class="w-full bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-2xl py-4 font-bold shadow-xl active:scale-95 transition-all">
                ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®
            </button>
        </div>

        <div id="auth-message" class="mt-4 text-center text-xs font-bold p-3 rounded-xl hidden"></div>

        <div class="relative flex items-center my-8">
            <div class="flex-grow border-t border-gray-200"></div>
            <span class="flex-shrink-0 mx-4 text-gray-400 text-[10px] font-bold uppercase tracking-widest">‡¶Ö‡¶•‡¶¨‡¶æ</span>
            <div class="flex-grow border-t border-gray-200"></div>
        </div>

        <!-- ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶¨‡¶æ‡¶ü‡¶® -->
        <button onclick="loginWithGoogle()" class="w-full bg-white text-gray-700 border-2 border-gray-100 rounded-2xl py-4 font-bold flex items-center justify-center gap-3 hover:bg-gray-50 active:scale-95 mb-4 transition-all">
            <svg class="w-6 h-6" viewBox="0 0 48 48"><path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"></path><path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"></path><path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"></path><path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"></path></svg>
            ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶¶‡¶ø‡ßü‡ßá ‡¶≤‡¶ó‡¶á‡¶®
        </button>

        <!-- ‡¶ó‡ßá‡¶∏‡ßç‡¶ü ‡¶Æ‡ßã‡¶° ‡¶¨‡¶æ‡¶ü‡¶® -->
        <button onclick="continueAsGuest()" class="w-full bg-indigo-50/50 text-indigo-600 rounded-2xl py-3 font-bold hover:bg-indigo-100 active:scale-95 text-sm transition-all">
            üïµÔ∏è‚Äç‚ôÇÔ∏è ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶õ‡¶æ‡ßú‡¶æ ‡¶™‡ßú‡ßÅ‡¶®
        </button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, updateProfile, GoogleAuthProvider, signInWithPopup, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // ‡¶´‡¶æ‡ßü‡¶æ‡¶∞‡¶¨‡ßá‡¶∏ ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶® (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ)
        const firebaseConfig = {
            apiKey: "AIzaSyB9WjFq4Ips9wMKoDmO8v2M6aZ2OxynQQo",
            authDomain: "youtale-f6845.firebaseapp.com",
            projectId: "youtale-f6845",
            storageBucket: "youtale-f6845.firebasestorage.app",
            messagingSenderId: "10854951568",
            appId: "1:10854951568:web:cffcc9813d858e130d8615",
            measurementId: "G-04CV21FSB7"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const googleProvider = new GoogleAuthProvider();
        const appId = "YouTale-Global-01";

        // ‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨ ‡¶∏‡ßÅ‡¶á‡¶ö‡¶ø‡¶Ç
        window.switchTab = (tab) => {
            const isLogin = tab === 'login';
            document.getElementById('form-login').classList.toggle('hidden', !isLogin);
            document.getElementById('form-register').classList.toggle('hidden', isLogin);
            document.getElementById('tab-login').classList.toggle('active', isLogin);
            document.getElementById('tab-register').classList.toggle('active', !isLogin);
            document.getElementById('auth-message').classList.add('hidden');
        };

        // ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶≤‡¶ó‡¶á‡¶®
        window.processLogin = async () => {
            const e = document.getElementById('login-email').value, p = document.getElementById('login-password').value;
            if(!e || !p) return showMsg('‡¶∏‡¶¨‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ò‡¶∞ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®!', true);
            try {
                showMsg('‡¶≤‡¶ó‡¶á‡¶® ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', false);
                await signInWithEmailAndPassword(auth, e, p);
                window.location.href = "dashboard.html";
            } catch(err) { showMsg('‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¨‡¶æ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßÅ‡¶≤!', true); }
        };

        // ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®
        window.processRegister = async () => {
            const n = document.getElementById('reg-name').value, e = document.getElementById('reg-email').value, p = document.getElementById('reg-password').value;
            if(!n || !e || p.length < 6) return showMsg('‡¶∏‡¶†‡¶ø‡¶ï ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶® (‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶Ö‡¶®‡ßç‡¶§‡¶§ ‡ß¨ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞)', true);
            try {
                showMsg('‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', false);
                const cred = await createUserWithEmailAndPassword(auth, e, p);
                await updateProfile(cred.user, { displayName: n });
                await setDoc(doc(db, 'artifacts', appId, 'users', cred.user.uid, 'profile'), {
                    name: n, email: e, role: 'user', earnings: 0, joinedAt: new Date().toISOString()
                });
                window.location.href = "dashboard.html";
            } catch(err) { showMsg('‡¶≠‡ßÅ‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶¨‡¶æ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤‡¶ü‡¶ø ‡¶Ü‡¶ó‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§', true); }
        };

        // ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü (Forgot Password)
        window.forgotPassword = async () => {
            const email = document.getElementById('login-email').value;
            if(!email) return showMsg('‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¨‡¶ï‡ßç‡¶∏‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤‡¶ü‡¶ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§', true);
            try {
                await sendPasswordResetEmail(auth, email);
                showMsg('‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¨‡¶¶‡¶≤‡¶æ‡¶®‡ßã‡¶∞ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§', false);
            } catch(err) { showMsg('‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤‡¶ü‡¶ø ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', true); }
        };

        // ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶≤‡¶ó‡¶á‡¶®
        window.loginWithGoogle = async () => {
            try {
                const res = await signInWithPopup(auth, googleProvider);
                const user = res.user;
                const userRef = doc(db, 'artifacts', appId, 'users', user.uid, 'profile');
                const docSnap = await getDoc(userRef);
                if (!docSnap.exists()) {
                    await setDoc(userRef, { name: user.displayName, email: user.email, role: 'user', earnings: 0, joinedAt: new Date().toISOString() });
                }
                window.location.href = "dashboard.html";
            } catch(err) { showMsg('‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶≤‡¶ó‡¶á‡¶® ‡¶∏‡¶´‡¶≤ ‡¶π‡ßü‡¶®‡¶ø‡•§', true); }
        };

        // ‡¶ó‡ßá‡¶∏‡ßç‡¶ü ‡¶Æ‡ßã‡¶°
        window.continueAsGuest = () => { localStorage.setItem('youtale_guest', 'true'); window.location.href = "dashboard.html"; };

        function showMsg(m, isE) {
            const box = document.getElementById('auth-message');
            box.innerText = m; box.className = `mt-4 text-center text-xs font-bold p-3 rounded-xl ${isE ? 'bg-red-100 text-red-600' : 'bg-green-100 text-green-700'}`;
            box.classList.remove('hidden');
        }
    </script>
</body>
</html>
